<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Active Map & Campus Setter</title>
</head>
<body>
  <h2>Set Current Active Map & Campus</h2>

  <label for="mapId">Map ID:</label>
  <input type="text" id="mapId" placeholder="Enter Map ID"><br><br>

  <label for="campusId">Campus ID:</label>
  <input type="text" id="campusId" placeholder="Enter Campus ID"><br><br>

  <button id="saveBtn">Save Active Map + Campus</button>

  <p id="status"></p>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    import { firebaseConfig } from "./firebaseConfig.js";

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const saveBtn = document.getElementById("saveBtn");
    const status = document.getElementById("status");

    saveBtn.addEventListener("click", async () => {
      const mapId = document.getElementById("mapId").value.trim();
      const campusId = document.getElementById("campusId").value.trim();

      if (!mapId || !campusId) {
        status.textContent = "❌ Please enter both Map ID and Campus ID.";
        return;
      }

      try {
        const mapRef = doc(db, "MapVersions", mapId);

        // Add/Update the fields in the Map doc
        await updateDoc(mapRef, {
          current_active_map: mapId,
          current_active_campus: campusId
        });

        status.textContent = `✅ Updated: Active Map = ${mapId}, Active Campus = ${campusId}`;
      } catch (err) {
        console.error("Error updating doc:", err);
        status.textContent = "❌ Failed to update, check console.";
      }
    });
  </script>
</body>
</html>
